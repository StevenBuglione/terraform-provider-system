---
layout: ""
page_title: "Provider: (Operating) System"
description: |-
  The (Operating) System Provider allows managing files, directories, packages, and services on remote servers on operating system level agent-less via SSH.
---

# (Operating) System Provider

Use the (Operating) System Provider to manage files, directories, packages, and services on remote systems on operating system level. The provider connects to remote systems via SSH and operates agent-less.

## Highlights

- Manage files, directories, users, groups, packages, and services on remote systems
- Connect to and authenticate with remote servers via SSH
- No agent on remote system required
- Seamless integration with Terraform providers of all major IaaS cloud providers
- Support for Debian, Alpine, and Fedora Linux confirmed via acceptance test suite

## Usage example

The following example connects to a remote Debian system, installs the nginx web server, and subsequently enables and starts the nginx service.

```terraform
provider "system" {
  ssh {
    host        = "10.12.13.14"
    port        = 22
    user        = "root"
    private_key = file("./root-ed25519")
  }
}

resource "system_packages_apt" "nginx" {
  package {
    name = "nginx"
  }
}

resource "system_service_systemd" "nginx" {
  name = "nginx"

  enabled = true
  status  = "started"

  depends_on = [
    system_packages_apt.nginx
  ]
}

```

## SSH connection

The SSH connection to the remote system can be established

- [directly](./guides/ssh-connect#direct-connection), or
- [indirectly via a bastion host](./guides/ssh-connect#proxy-bastion-host-connection)

Refer to the page on [SSH connection](./guides/ssh-connect) for details and configuration examples.

## SSH authentication

The provider supports the following SSH authentication methods.

- [password](./guides/ssh-auth#password)
- [private key](./guides/ssh-auth#private-key)
- [ssh agent](./guides/ssh-auth#agent)
- user certificate

The provider supports privilege escalation on the remote system via sudo.

Refer to the page on [SSH authentication](./guides/ssh-auth) for details and configuration examples.

## SSH provisioner like configuration

-> Prefer the recommended configuration as described in previous sections on [SSH connection](#ssh-connection) and [SSH authentication](#ssh-authentication) over the SSH provisioner like configuration. The SSH provisioner like configuration does not support all features.

You may reuse your existing [Terraform SSH provisioner configuration](https://www.terraform.io/language/resources/provisioners/connection) to configure the connection to the remote system.

The [connection block of the Terraform SSH provisioner](https://www.terraform.io/language/resources/provisioners/connection#connection-block) is mostly compatible to the [`connection` block](#nestedblock--connection) of the provider.

```terraform
provider "system" {
  connection {
    host        = "192.168.32.4"
    port        = 22
    user        = "root"
    private_key = file("./root.key")

    bastion_host        = "10.12.13.14"
    bastion_port        = 22
    bastion_user        = "bastion"
    bastion_private_key = file("./bastion.key")
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `connection` (Block List, Max: 1) (see [below for nested schema](#nestedblock--connection))
- `parallel` (Number) Maximum number of concurrent ssh connections to the remote. Increase the number of connections to parallelize interaction with the remote. Set to `0` to not limit the number of concurrent connections. Defaults to `1`.
- `proxy` (Block List, Max: 1) (see [below for nested schema](#nestedblock--proxy))
- `retry` (Boolean) If `true`, the provider retries failed connection attempts to the remote within the configured timeout. A constant backoff of 1s is planned between failed connection attempts. Defaults to `true`.
- `ssh` (Block List, Max: 1) (see [below for nested schema](#nestedblock--ssh))
- `sudo` (Boolean) If `true`, commands are executed on the remote using `sudo` by default. Enable `sudo` to connect to the remote with an unprivileged used and execute commands as root. As a prerequisite `sudo` must be installed and configured on the remote system. The `user` must be able to run `sudo` without password (`NOPASSWD`). Defaults to `false`.
- `timeout` (String) Timeout for the connection to the remote to become available. This timeout include multiple connection attempts if retires are enabled. Provided as a duration string like `30s` or `5m`. Defaults to `5m`.

<a id="nestedblock--connection"></a>
### Nested Schema for `connection`

Required:

- `host` (String) The host of the remote ssh server to connect to.

Optional:

- `agent` (Boolean) Set to `false` to disable using an ssh agent to authenticate. Defaults to `true`.
- `agent_identity` (String) The preferred identity from the ssh agent for authentication.
- `bastion_certificate` (String) The ssh user certificate to authenticate with the bastion ssh server. The certificate can be provided as text or loaded from a file using the `file` function. Must be used with in conjunction with `bastion_private_key`. Mutually exclusive with `bastion_password`.
- `bastion_host` (String) Setting this attribute enables a bastion connection to the remote ssh server. The host of the bastion ssh server through which to connect to the remote ssh server.
- `bastion_host_key` (String) The public key or the CA certificate of the bastion ssh host to verify the bastion host authenticity.
- `bastion_password` (String) The password that should be used to authenticate. Mutually exclusive with `bastion_private_key`.
- `bastion_port` (Number) The port of the bastion ssh server to connect to. Defaults to `22`.
- `bastion_private_key` (String) The SSH private key to authenticate with the bastion ssh server. The key can be provided as text or loaded from a file using the `file` function. The key must not be encrypted. Mutually exclusive with `bastion_password`.
- `bastion_user` (String) The user that should be used to connect to the bastion ssh server. Defaults to `root`.
- `certificate` (String) The ssh user certificate to authenticate with the remote ssh server. The certificate can be provided as text or loaded from a file using the `file` function. Must be used with in conjunction with `private_key`. Mutually exclusive with `password`.
- `host_key` (String) The public key or the CA certificate of the remote ssh host to verify the remote authenticity.
- `password` (String) The password that should be used to authenticate with the remote ssh server. Mutually exclusive with `private_key`.
- `port` (Number) The port of the remote ssh server to connect to. Defaults to `22`.
- `private_key` (String) The SSH private key to authenticate with the remote ssh server. The key can be provided as text or loaded from a file using the `file` function. The key must not be encrypted. Mutually exclusive with `password`.
- `timeout` (String) The timeout to wait for the connection to be established. Should be provided as a string like `30s` or `5m`. Defaults to 5 minutes.
- `user` (String) The user that should be used to connect to the remote ssh server. Defaults to `root`.


<a id="nestedblock--proxy"></a>
### Nested Schema for `proxy`

Optional:

- `ssh` (Block List, Max: 1) (see [below for nested schema](#nestedblock--proxy--ssh))

<a id="nestedblock--proxy--ssh"></a>
### Nested Schema for `proxy.ssh`

Required:

- `host` (String) The host of the remote ssh server to connect to.

Optional:

- `agent` (Boolean) If `true`, an ssh agent is used to to authenticate. Defaults to `false`.
- `agent_identities` (List of String) List of preferred identities from the ssh agent for authentication. Expected format of an identity is a base64 encoded OpenSSH public key (`authorized_keys` format).
- `agent_identity` (String) The preferred identity from the ssh agent for authentication. Expected format of an identity is a base64 encoded OpenSSH public key (`authorized_keys` format).
- `certificate` (String) The ssh user certificate to authenticate with the remote ssh server. The certificate can be provided as text or loaded from a file using the `file` function. Expected format of the certificate is a base64 encoded OpenSSH public key (`authorized_keys` format). Must be used with in conjunction with `private_key`. Mutually exclusive with `password`.
- `host_key` (String) The public key or the CA certificate of the remote ssh host to verify the remote authenticity. Expected format of the host key is a base64 encoded OpenSSH public key (`authorized_keys` format).
- `password` (String) The password that should be used to authenticate with the remote ssh server. Mutually exclusive with `private_key`.
- `port` (Number) The port of the remote ssh server to connect to. Defaults to `22`.
- `private_key` (String) The SSH private key to authenticate with the remote ssh server. The key can be provided as string or loaded from a file using the `file` function. Supported private keys are unencrypted pem encoded RSA (PKCS#1), PKCS#8, DSA (OpenSSL), and ECDSA private keys. Mutually exclusive with `password`.
- `timeout` (String) Timeout of a single connection attempt. Should be provided as a string like `30s` or `5m`. Defaults to 30 seconds (`30s`).
- `user` (String) The user that should be used to connect to the remote ssh server.



<a id="nestedblock--ssh"></a>
### Nested Schema for `ssh`

Required:

- `host` (String) The host of the remote ssh server to connect to.

Optional:

- `agent` (Boolean) If `true`, an ssh agent is used to to authenticate. Defaults to `false`.
- `agent_identities` (List of String) List of preferred identities from the ssh agent for authentication. Expected format of an identity is a base64 encoded OpenSSH public key (`authorized_keys` format).
- `agent_identity` (String) The preferred identity from the ssh agent for authentication. Expected format of an identity is a base64 encoded OpenSSH public key (`authorized_keys` format).
- `certificate` (String) The ssh user certificate to authenticate with the remote ssh server. The certificate can be provided as text or loaded from a file using the `file` function. Expected format of the certificate is a base64 encoded OpenSSH public key (`authorized_keys` format). Must be used with in conjunction with `private_key`. Mutually exclusive with `password`.
- `host_key` (String) The public key or the CA certificate of the remote ssh host to verify the remote authenticity. Expected format of the host key is a base64 encoded OpenSSH public key (`authorized_keys` format).
- `password` (String) The password that should be used to authenticate with the remote ssh server. Mutually exclusive with `private_key`.
- `port` (Number) The port of the remote ssh server to connect to. Defaults to `22`.
- `private_key` (String) The SSH private key to authenticate with the remote ssh server. The key can be provided as string or loaded from a file using the `file` function. Supported private keys are unencrypted pem encoded RSA (PKCS#1), PKCS#8, DSA (OpenSSL), and ECDSA private keys. Mutually exclusive with `password`.
- `timeout` (String) Timeout of a single connection attempt. Should be provided as a string like `30s` or `5m`. Defaults to 30 seconds (`30s`).
- `user` (String) The user that should be used to connect to the remote ssh server.
